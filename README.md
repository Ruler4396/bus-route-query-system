# 城市公交在线查询系统

> 基于 Spring Boot 的毕业设计项目，提供公交线路查询、实时追踪、智能换乘等核心功能演示

---

## 项目概述

本系统是一个**面向毕业设计的公交查询演示系统**，采用前后端分离架构，支持**离线部署演示**。系统实现了公交线路查询、站点信息检索、模拟实时车辆追踪、智能换乘规划等核心功能，展示了完整的技术实现方案和可扩展的代码架构。

### 设计特点

| 特点 | 说明 |
|------|------|
| 🎓 **毕业设计** | 功能聚焦，代码清晰，适合答辩演示 |
| 📦 **离线运行** | 无需外部API，单机部署即可完整演示 |
| 🎨 **精致小巧** | 核心功能精简，UI美观，交互流畅 |
| 🔧 **可扩展** | 模块化设计，易于改造为实际生产系统 |
| 📱 **响应式** | 支持PC/平板/手机多端访问 |

---

## 更新日志

### v1.0.0 (2024-12-24)

- [x] 项目初始化，搭建Spring Boot + MyBatis-Plus框架
- [x] 创建13个核心数据表（用户、公交路线、公告、留言等）
- [x] 实现12个服务层模块（Service + ServiceImpl）
- [x] 完成Docker容器化部署配置
- [x] 实现管理后台与前台用户界面
- [x] GitHub仓库创建并推送代码

---

## 演示功能规划

### 已实现功能 ✅

| 模块 | 功能 | 状态 |
|------|------|------|
| **用户系统** | 注册/登录、个人中心、权限管理 | ✅ |
| **路线查询** | 按名称/起点/终点/站点搜索 | ✅ |
| **内容管理** | 公交路线、公告、友情链接CRUD | ✅ |
| **社交互动** | 评论、点赞/踩、收藏、留言 | ✅ |
| **后台管理** | 完整的管理后台界面 | ✅ |

### 演示增强功能 🚧

#### 优先级P0：核心演示功能（毕业答辩必选）

| 功能 | 实现方案 | 演示效果 | 预计工时 |
|------|----------|----------|----------|
| **地图可视化** | Leaflet + OpenStreetMap | 路线地图、站点标注 | 1周 |
| **模拟实时位置** | 定时器 + 轨迹算法 | 车辆动态移动动画 | 1周 |
| **换乘规划** | Dijkstra算法 | 多方案推荐展示 | 1周 |
| **到站预测** | 距离速度公式 | ETA倒计时显示 | 3天 |

#### 优先级P1：体验优化（加分项）

| 功能 | 实现方案 | 演示效果 | 预计工时 |
|------|----------|----------|----------|
| **历史记录** | LocalStorage | 快捷查询入口 | 2天 |
| **离线缓存** | Service Worker | 无网络可访问 | 3天 |
| **路线收藏** | 数据库 + UI | 我的收藏列表 | 已有 |
| **数据导出** | Excel | 路线数据导出 | 2天 |

#### 优先级P2：可选增强（时间充裕再做）

| 功能 | 实现方案 | 演示效果 | 预计工时 |
|------|----------|----------|----------|
| **站点详情** | 模拟POI数据 | 周边设施展示 | 3天 |
| **夜间模式** | CSS变量 | 深色主题切换 | 2天 |
| **数据统计** | ECharts | 访问量图表 | 3天 |

---

## 技术架构

### 后端技术栈

```
Spring Boot 2.2.2.RELEASE
├── MyBatis-Plus 2.3        # ORM框架
├── MySQL 8.0               # 数据库
├── Shiro 1.3.2             # 权限管理
└── Hutool 4.0.12           # 工具类库
```

### 前端技术栈

```
管理后台：Vue.js + ElementUI
前台页面：Vue.js + jQuery + Bootstrap
地图组件：Leaflet + OpenStreetMap（离线瓦片）
图表组件：ECharts（可选）
```

### 系统架构

```
┌─────────────────────────────────────────────────────┐
│                    用户层                             │
│    管理后台(Vue)    │    前台页面(Vue/jQuery)        │
├─────────────────────────────────────────────────────┤
│                   表现层                              │
│    地图组件(Leaflet)  │  图表组件(ECharts)           │
├─────────────────────────────────────────────────────┤
│                   API网关层                           │
│        RESTful API  │  WebSocket(实时推送)           │
├─────────────────────────────────────────────────────┤
│                   业务逻辑层                          │
│  Service层 (12个模块) │  算法模块(换乘/ETA)          │
├─────────────────────────────────────────────────────┤
│                   数据访问层                          │
│        MyBatis-Plus  │  DAO层 (13个Mapper)           │
├─────────────────────────────────────────────────────┤
│                   数据存储层                          │
│              MySQL 8.0 (13张表)                      │
└─────────────────────────────────────────────────────┘
```

---

## 核心模块设计

### 1. 地图可视化模块

```javascript
// 技术选型：Leaflet + OpenStreetMap
// 优势：开源免费、无需API Key、支持离线瓦片

核心功能：
├── 地图初始化
│   ├── 设置中心点和缩放级别
│   ├── 加载OpenStreetMap瓦片
│   └── 自定义地图样式
├── 路线绘制
│   ├── 根据站点坐标绘制Polyline
│   ├── 设置线路颜色和样式
│   └── 添加线路标签
├── 站点标注
│   ├── Marker标记
│   ├── Popup信息窗口
│   └── 站点图标样式
└── 车辆标注
    ├── 实时位置更新
    ├── 方向箭头
    └── 点击查看详情
```

### 2. 模拟实时位置模块

```javascript
// 演示方案：定时器 + 插值算法
// 优势：无需GPS设备，完整演示效果

实现思路：
├── 数据准备
│   ├── 设置线路站点坐标
│   ├── 定义车辆初始位置
│   └── 设置移动速度
├── 位置模拟
│   ├── 定时器触发（每2秒）
│   ├── 计算下一个位置坐标
│   └── 更新车辆Marker位置
├── 到站判断
│   ├── 计算与下一站距离
│   ├── 判断是否到站
│   └── 触发到站事件
└── 前端推送
    ├── WebSocket连接
    ├── 位置数据推送
    └── UI实时更新
```

### 3. 智能换乘规划模块

```java
// 算法选择：Dijkstra最短路径
// 演示重点：算法原理展示

算法流程：
├── 数据结构
│   ├── 站点邻接表构建
│   ├── 线路站点映射
│   └── 换乘点识别
├── 算法实现
│   ├── Dijkstra求解最短路径
│   ├── 直达方案查询
│   ├── 一次换乘方案查询
│   └── 多方案对比排序
└── 结果展示
    ├── 方案A：直达（最快）
    ├── 方案B：一次换乘（推荐）
    ├── 方案C：两次换乘（备选）
    └── 预计时间、距离、票价
```

### 4. 到站时间预测模块

```java
// 简化公式：ETA = 距离 / 平均速度
// 演示重点：计算逻辑展示

计算逻辑：
├── 参数设置
│   ├── 车辆当前位置
│   ├── 目标站点位置
│   ├── 平均行驶速度（15km/h）
│   └── 停站时间（30秒/站）
├── 计算过程
│   ├── 计算剩余距离（几何距离）
│   ├── 考虑停靠站点数
│   ├── 计算行驶时间
│   └── 加上停站时间
└── 结果返回
    ├── 预计到达时间
    ├── 剩余站数
    └── 剩余距离
```

---

## 快速开始

### 环境要求

| 组件 | 版本 | 说明 |
|------|------|------|
| JDK | 1.8+ | 必需 |
| Maven | 3.6+ | 必需 |
| MySQL | 8.0+ | 必需 |
| Docker | 20.10+ | 推荐 |

### 本地开发

```bash
# 1. 创建数据库
mysql -u root -p < init-db.sql

# 2. 修改配置
# 编辑 src/main/resources/application.yml
# 设置数据库连接信息

# 3. 启动项目
mvn spring-boot:run

# 4. 访问系统
# 前台：http://localhost:8080/springbootmf383/front/index.html
# 后台：http://localhost:8080/springbootmf383/admin/dist/index.html
```

### Docker 部署

```bash
# 一键启动
docker compose up -d

# 查看日志
docker compose logs -f app
```

### 默认账号

| 角色 | 用户名 | 密码 |
|------|--------|------|
| 管理员 | `abo` | `abo` |
| 普通用户 | 需注册 | 需注册 |

---

## 答辩演示要点

### 功能演示清单

| 序号 | 功能 | 操作步骤 | 预期结果 |
|------|------|----------|----------|
| 1 | 用户注册 | 填写信息提交 | 注册成功，自动登录 |
| 2 | 路线查询 | 输入"101路" | 显示该线路详情 |
| 3 | 地图展示 | 点击"地图"按钮 | 地图显示线路和站点 |
| 4 | 实时位置 | 观察车辆图标 | 车辆沿路线移动 |
| 5 | 换乘规划 | 输入起点终点 | 显示多种换乘方案 |
| 6 | 到站预测 | 查看预计时间 | 显示ETA倒计时 |
| 7 | 收藏功能 | 点击收藏 | 加入我的收藏 |
| 8 | 评论留言 | 发表评论 | 评论成功显示 |
| 9 | 管理后台 | 登录后台 | 展示管理功能 |
| 10 | 数据导出 | 点击导出按钮 | 下载Excel文件 |

### 技术亮点说明

| 亮点 | 说明 |
|------|------|
| **前后端分离** | Vue + Spring Boot，RESTful API设计 |
| **地图离线方案** | Leaflet + OSM，无需API Key，可离线部署 |
| **实时模拟算法** | 定时器 + 插值，完整演示位置追踪效果 |
| **图论算法应用** | Dijkstra最短路径，换乘智能规划 |
| **缓存优化** | Redis热点数据缓存 |
| **响应式设计** | 适配多种设备屏幕 |

### 可能的答辩问题

| 问题 | 回答要点 |
|------|----------|
| 如何获取实时数据？ | 演示版使用模拟数据，生产环境可对接GPS数据源 |
| 如何处理高并发？ | 引入Redis缓存 + 数据库索引优化 |
| 地图如何离线？ | 使用本地瓦片服务或OSM在线服务 |
| 如何扩展？ | 模块化设计，预留接口，易于替换数据源 |
| 算法复杂度？ | Dijkstra O(V²)，可优化为A* O(E+VlogV) |

---

## 项目结构

```
bus-route-query-system/
├── src/main/java/com/
│   ├── controller/        # 控制器层
│   ├── service/          # 业务逻辑层
│   ├── dao/              # 数据访问层
│   ├── entity/           # 实体类
│   ├── utils/            # 工具类
│   └── config/           # 配置类
├── src/main/resources/
│   ├── admin/            # 管理后台前端
│   ├── front/            # 用户前台前端
│   └── application.yml   # 应用配置
├── images/               # 项目截图
├── init-db.sql          # 数据库脚本
├── docker-compose.yml   # Docker配置
├── Dockerfile           # 镜像构建
└── README.md            # 项目文档
```

---

## 数据库设计

### 核心数据表

| 表名 | 说明 | 主要字段 |
|------|------|----------|
| `users` | 管理员表 | id, username, password, role |
| `yonghu` | 用户表 | id, zhanghao, mima, xingming |
| `gongjiaoluxian` | 公交路线表 | id, luxianbianhao, luxianmingcheng, qidianzhanming, zhongdianzhanming |
| `wangzhangonggao` | 网站公告表 | id, biaoti, neirong, fabushijian |
| `messages` | 留言建议表 | id, userid, content, reply |
| `chat` | 在线提问表 | id, userid, ask, reply |

---

## 扩展改造指南

### 从演示版到生产版

```diff
# 模拟数据 → 真实数据
- 定时器模拟位置
+ GPS设备数据接口

# 在线地图 → 本地瓦片
- OpenStreetMap在线服务
+ 自建瓦片服务器

# 单机部署 → 集群部署
- 单机MySQL
+ MySQL主从 + Redis集群

# 简单认证 → 完善安全
- 明文密码
+ BCrypt加密 + JWT

# 基础算法 → 优化算法
- Dijkstra
+ A* + 实时路况 + 机器学习
```

---

## 常用命令

```bash
# Maven操作
mvn clean package             # 打包
mvn spring-boot:run           # 运行

# Docker操作
docker compose up -d          # 启动服务
docker compose down           # 停止服务
docker compose logs app       # 查看日志
docker compose restart        # 重启服务

# Git操作
git pull origin main          # 拉取更新
git add . && git commit       # 提交更改
```

---

## 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

---

## 联系方式

- 仓库地址：https://github.com/Ruler4396/bus-route-query-system
- 问题反馈：[Issues](https://github.com/Ruler4396/bus-route-query-system/issues)

---

**毕业设计项目 | Powered by Spring Boot | Made with ❤️ by Ruler4396**
