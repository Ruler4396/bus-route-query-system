# 城市公交在线查询系统

> 基于 Spring Boot 框架的智能公交查询系统，提供线路查询、站点检索、实时追踪、智能换乘等功能

---

## 项目概述

本系统旨在设计和实现一个基于Spring Boot框架的城市公交在线查询系统，解决市民出行中公交信息获取不便、实时性差、换乘方案不智能等痛点。通过该系统用户能够便捷查询公交线路、站点、实时到站信息及最优换乘方案。

---

## 更新日志

### v1.0.0 (2024-12-24)

- [x] 项目初始化，搭建Spring Boot + MyBatis-Plus框架
- [x] 创建13个核心数据表（用户、公交路线、公告、留言等）
- [x] 实现12个服务层模块（Service + ServiceImpl）
- [x] 完成Docker容器化部署配置
- [x] 实现管理后台与前台用户界面
- [x] GitHub仓库创建并推送代码

---

## 开发计划

### 一、主要任务和目标

#### 主要任务

| 任务 | 描述 | 优先级 |
|------|------|--------|
| 公交线路查询 | 支持按线路名称、编号查询 | 高 |
| 站点信息检索 | 查询站点位置、经过线路 | 高 |
| 实时位置追踪 | 车辆实时位置与到站预测 | 中 |
| 智能换乘规划 | 最优换乘方案推荐 | 高 |
| 到站提醒 | 推送即将到站通知 | 中 |

#### 技术目标

| 指标 | 目标值 |
|------|--------|
| 接口响应时间 | < 500ms |
| 并发访问支持 | ≥ 500 |
| 系统可用性 | 7×24小时 |
| 容错降级 | 支持 |

### 二、开发进度

#### 已完成 ✅

| 模块 | 内容 | 完成时间 |
|------|------|----------|
| 需求分析 | 用例分析、系统架构设计 | - |
| 数据库设计 | ER图、13张数据表、索引优化 | - |
| 后端框架 | Spring Boot + MyBatis-Plus + MySQL | 2024-12-24 |
| 服务层实现 | 12个Service接口 + 实现类 | 2024-12-24 |
| API接口 | RESTful风格接口（Controller层） | - |
| 前端界面 | Vue管理后台 + jQuery前台 | - |
| Docker部署 | docker-compose + 多阶段构建 | 2024-12-24 |

#### 进行中 🚧

| 任务 | 预计完成 |
|------|----------|
| 实时数据接入 | TBD |

#### 计划中 📋

##### 阶段一：核心功能补齐（1-2个月）⭐

| 优先级 | 功能模块 | 技术方案 | 说明 |
|--------|----------|----------|------|
| **P0** | 地图集成 | 高德地图 API | 地图展示、路线绘制、站点标注 |
| **P0** | 实时车辆位置 | WebSocket + Redis | 车辆GPS追踪、位置推送 |
| **P0** | 到站时间预测 | 算法 + 历史数据 | ETA计算、实时更新 |
| **P0** | 智能换乘规划 | Dijkstra/A*算法 | 多方案对比、最优路线推荐 |
| **P1** | 到站提醒 | 推送服务 | 推送通知、震动提醒 |

##### 阶段二：用户体验优化（2-3个月）🚀

| 优先级 | 功能模块 | 技术方案 | 说明 |
|--------|----------|----------|------|
| **P0** | 移动端适配 | PWA + 响应式设计 | 微信小程序、离线支持 |
| **P1** | 数据缓存 | Redis + Caffeine | 二级缓存、预加载 |
| **P1** | 历史查询 | 本地存储 | 查询记录、快捷查询 |
| **P1** | 分享功能 | 社交SDK | 微信、QQ分享 |
| **P2** | 站点详情 | 地图POI | 周边设施、出口信息 |
| **P2** | 拥堵信息 | 第三方API | 实时路况、避堵推荐 |

##### 阶段三：高级功能（3-4个月）💎

| 优先级 | 功能模块 | 技术方案 | 说明 |
|--------|----------|----------|------|
| **P1** | 票务系统 | 支付接口 | 在线购票、二维码乘车 |
| **P2** | 数据分析 | 大数据 + AI | 用户画像、运营报表 |
| **P2** | 智能预测 | 机器学习 | 客流预测、运力调度 |
| **P2** | 广告系统 | 广告SDK | 商业变现 |
| **P3** | 社区功能 | UGC系统 | 用户互动、内容运营 |

##### 核心缺失功能对比

| 功能 | 本项目 | 车来了 | 高德地图 | 差距评估 |
|------|--------|--------|----------|----------|
| 实时车辆位置 | ❌ | ✅ | ✅ | 致命缺失 |
| 到站时间预测 | ❌ | ✅ | ✅ | 致命缺失 |
| 地图可视化 | ❌ | ✅ | ✅ | 致命缺失 |
| 智能换乘规划 | ❌ | ✅ | ✅ | 致命缺失 |
| 到站提醒 | ❌ | ✅ | ✅ | 重要缺失 |
| 离线查询 | ❌ | ✅ | ✅ | 重要缺失 |
| 历史记录 | ❌ | ✅ | ✅ | 重要缺失 |
| 分享功能 | ❌ | ✅ | ✅ | 重要缺失 |
| 票务系统 | ❌ | ❌ | ✅ | 增值功能 |
| 数据平台 | ❌ | ❌ | ✅ | 增值功能 |

---

### 三、功能完善计划详解

#### 3.1 实时功能模块

```
实时车辆位置追踪
├── GPS数据接入
│   ├── 车辆GPS设备数据接口
│   ├── 位置数据解析与存储
│   └── 数据有效性验证
├── 实时位置推送
│   ├── WebSocket服务
│   ├── 位置更新算法
│   └── 客户端订阅机制
└── 到站时间计算
    ├── 剩余距离计算
    ├── 速度预估
    └── 到站时间预测
```

#### 3.2 地图集成模块

```
地图可视化
├── 基础地图展示
│   ├── 高德地图API集成
│   ├── 地图样式定制
│   └── 缩放与交互
├── 路线绘制
│   ├── 线路坐标数据
│   ├── 路线样式渲染
│   └── 站点标记
├── 车辆标注
│   ├── 实时位置标注
│   ├── 车辆方向箭头
│   └── 拥堵状态颜色
└── 交互功能
    ├── 点击查看详情
    ├── 路线规划预览
    └── 周边设施检索
```

#### 3.3 路径规划模块

```
智能换乘规划
├── 数据结构
│   ├── 站点邻接表构建
│   ├── 线路拓扑关系
│   └── 换乘点识别
├── 算法实现
│   ├── Dijkstra最短路径
│   ├── A*启发式搜索
│   └── 多方案对比
└── 结果展示
    ├── 直达方案
    ├── 一次换乘方案
    ├── 多次换乘方案
    └── 综合推荐（时间+价格+舒适度）
```

#### 3.4 移动端优化

```
移动端适配
├── PWA应用
│   ├── Service Worker
│   ├── 离线缓存策略
│   └── 添加到主屏幕
├── 微信小程序
│   ├── 小程序前端
│   ├── 微信登录
│   └── 微信支付
└── 响应式优化
    ├── 移动端布局
    ├── 触摸交互
    └── 性能优化
```

---

## 技术架构

### 后端技术栈

```
Spring Boot 2.2.2.RELEASE
├── MyBatis-Plus 2.3        # ORM框架
├── MySQL 8.0               # 数据库
├── Shiro 1.3.2             # 权限管理
├── Hutool 4.0.12           # 工具类库
└── Swagger                 # API文档
```

### 前端技术栈

```
管理后台：Vue.js + ElementUI
前台页面：Vue.js + jQuery + Bootstrap
地图：待集成高德/百度地图API
```

### 系统架构

```
┌─────────────────────────────────────────────────────┐
│                    用户层                             │
│    管理后台(Vue)    │    前台页面(Vue/jQuery)        │
├─────────────────────────────────────────────────────┤
│                   API网关层                           │
│        RESTful API  │  Swagger文档                   │
├─────────────────────────────────────────────────────┤
│                   业务逻辑层                          │
│  Service层 (12个模块) │  Controller层 (13个控制器)    │
├─────────────────────────────────────────────────────┤
│                   数据访问层                          │
│        MyBatis-Plus  │  DAO层 (13个Mapper)           │
├─────────────────────────────────────────────────────┤
│                   数据存储层                          │
│              MySQL 8.0 (13张表)                      │
└─────────────────────────────────────────────────────┘
```

---

## 快速开始

### 环境要求

| 组件 | 版本 |
|------|------|
| JDK | 1.8+ |
| Maven | 3.6+ |
| MySQL | 8.0+ |
| Docker | 20.10+ (可选) |

### 方式一：Docker 部署（推荐）

```bash
# 1. 克隆项目
git clone https://github.com/Ruler4396/bus-route-query-system.git
cd bus-route-query-system

# 2. 一键启动
docker compose up -d

# 3. 访问系统
# 前台：http://localhost:8080/springbootmf383/front/index.html
# 后台：http://localhost:8080/springbootmf383/admin/dist/index.html
```

### 方式二：本地开发

```bash
# 1. 创建数据库
mysql -u root -p < init-db.sql

# 2. 修改配置
# 编辑 src/main/resources/application.yml
# 设置数据库连接信息

# 3. 启动项目
mvn spring-boot:run
```

### 默认账号

| 角色 | 用户名 | 密码 |
|------|--------|------|
| 管理员 | `abo` | `abo` |
| 普通用户 | 需注册 | 需注册 |

---

## API 接口

### 认证接口

| 接口 | 方法 | 说明 |
|------|------|------|
| `/users/login` | POST | 用户登录 |
| `/users/register` | POST | 用户注册 |
| `/users/logout` | GET | 退出登录 |

### 公交查询接口

| 接口 | 方法 | 说明 |
|------|------|------|
| `/gongjiaoluxian/list` | GET | 公交路线列表 |
| `/gongjiaoluxian/info/{id}` | GET | 路线详情 |
| `/gongjiaoluxian/page` | GET | 分页查询 |

### 其他接口

- 公告管理：`/wangzhangonggao/*`
- 留言建议：`/messages/*`
- 在线提问：`/chat/*`
- 友情链接：`/youqinglianjie/*`

完整API文档：启动后访问 `/swagger-ui.html`

---

## 数据库设计

### 核心数据表

| 表名 | 说明 | 主要字段 |
|------|------|----------|
| `users` | 管理员表 | id, username, password, role |
| `yonghu` | 用户表 | id, zhanghao, mima, xingming |
| `gongjiaoluxian` | 公交路线表 | id, luxianbianhao, luxianmingcheng, qidianzhanming, zhongdianzhanming |
| `wangzhangonggao` | 网站公告表 | id, biaoti, neirong, fabushijian |
| `messages` | 留言建议表 | id, userid, content, reply |
| `chat` | 在线提问表 | id, userid, ask, reply |

### ER关系

```
用户(yonghu) ─┬─> 留言(messages)
              ├─> 收藏(storeup)
              ├─> 提问(chat)
              └─> 评论(discuss*)

管理员(users) ─> 管理(所有模块)
```

---

## 系统截图

### 前台用户界面

| 功能 | 截图 |
|------|------|
| 首页 | ![首页](images/fb3f40d0942ead058b95439952adc3f.png) |
| 公交路线 | ![公交路线](images/e4e6c0d95f862ad4e19c9b7d61aeac7.png) |
| 网站公告 | ![网站公告](images/475b0c6ed6cb389a9c74e6b6a96827b.png) |

### 管理后台

| 功能 | 截图 |
|------|------|
| 登录 | ![登录](images/e18148b3b35ba855d7db2439479f8dc.png) |
| 用户管理 | ![用户管理](images/e081ea119e954dd1daeabc471cad35f.png) |
| 路线管理 | ![路线管理](images/93e786eef841fa08df36803e3c1967e.png) |
| 留言管理 | ![留言管理](images/63b89ef48b37000d245773e31dfbaa3.png) |

---

## 常用命令

```bash
# Docker操作
docker compose up -d          # 启动服务
docker compose down           # 停止服务
docker compose logs app       # 查看应用日志
docker compose restart        # 重启服务

# Maven操作
mvn clean package             # 打包
mvn spring-boot:run           # 运行

# Git操作
git pull origin main          # 拉取更新
git add . && git commit       # 提交更改
```

---

## 贡献指南

欢迎提交 Issue 和 Pull Request！

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

---

## 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

---

## 联系方式

- 仓库地址：https://github.com/Ruler4396/bus-route-query-system
- 问题反馈：[Issues](https://github.com/Ruler4396/bus-route-query-system/issues)

---

**Powered by Spring Boot | Made with ❤️ by Ruler4396**
